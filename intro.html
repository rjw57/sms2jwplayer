

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; sms2jwplayer  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="sms2jwplayer  documentation" href="index.html"/>
        <link rel="next" title="CSV Export" href="csvexport.html"/>
        <link rel="prev" title="sms2jwplayer: export SMS content to jwplayer" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> sms2jwplayer
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-tests">Running tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#command-line-interface">Command line interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generating-an-mrss-feed">Generating an MRSS Feed</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="csvexport.html">CSV Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">sms2jwplayer</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/intro.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference external" href="https://sms.cam.ac.uk/">Streaming Media Service</a> offered by the
University of Cambridge is to be re-architectured to use <a class="reference external" href="https://www.jwplayer.com/">jwplayer</a> as a storage backend. This repository contains
tooling to help with this migration.</p>
<p>The jwplayer console allows importing videos via an MRSS feed. In order to
perform the initial import of SMS content to jwplayer, we will generate an
archive MRSS feed of all SMS content. The <a class="reference external" href="https://en.wikipedia.org/wiki/Media_RSS">MRSS</a> feed is generated by <a class="reference internal" href="reference.html#module-sms2jwplayer.genmrss" title="sms2jwplayer.genmrss"><code class="xref any py py-mod docutils literal"><span class="pre">genmrss</span></code></a>
from a CSV export.</p>
<p>Jwplayer takes care of de-duplicating videos in the feed in order to obtain only
new feed videos. In this way, we can run the <a class="reference internal" href="reference.html#module-sms2jwplayer.genmrss" title="sms2jwplayer.genmrss"><code class="xref any py py-mod docutils literal"><span class="pre">genmrss</span> <span class="pre">command</span></code></a>
regularly and automatically ingest new videos.</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>It is recommended that the tool be run inside of a virtualenv:</p>
<div class="code console highlight-default"><div class="highlight"><pre><span></span>$ virtualenv -p $(which python3) venv
$ source venv/bin/activate
</pre></div>
</div>
<p>Once the virtualenv is active, the tool may be checked out with <code class="docutils literal"><span class="pre">git</span></code> and
installed via the <code class="docutils literal"><span class="pre">pip</span></code> command:</p>
<div class="code console highlight-default"><div class="highlight"><pre><span></span>$ git clone $REPO sms2jwplayer
$ cd sms2jwplayer
$ pip install .
</pre></div>
</div>
<p>Where <code class="docutils literal"><span class="pre">$REPO</span></code> is replaced with the location of the <code class="docutils literal"><span class="pre">sms2jwplayer</span></code>
repository.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">--editable</span></code> or <code class="docutils literal"><span class="pre">-e</span></code> flag may be passed to <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span></code> to
symlink files into the Python package path rather than copy them. This
allows for local development on the tool.</p>
</div>
</div>
<div class="section" id="running-tests">
<h2>Running tests<a class="headerlink" href="#running-tests" title="Permalink to this headline">¶</a></h2>
<p>Tests are run via the <a class="reference external" href="https://tox.readthedocs.io/en/latest/">tox</a> automation
tool. Firstly, install tox:</p>
<div class="code console highlight-default"><div class="highlight"><pre><span></span>$ pip install tox
</pre></div>
</div>
<p>In the repository root, run the <code class="docutils literal"><span class="pre">tox</span></code> command. The default environment runs
tests in whichever Python 3 version is installed and prints coverage
information. Configuration can be found in <a class="reference download internal" href="_downloads/tox.ini" download=""><code class="xref download docutils literal"><span class="pre">the</span> <span class="pre">tox.ini</span> <span class="pre">file</span></code></a>.</p>
</div>
<div class="section" id="command-line-interface">
<h2>Command line interface<a class="headerlink" href="#command-line-interface" title="Permalink to this headline">¶</a></h2>
<div class="highlight-docopt"><div class="highlight"><pre><span></span>Tool to support bulk import of University of Cambridge SMS into JWPlayer.

Usage:
    sms2jwplayer (-h | --help)
    sms2jwplayer genmrss [--verbose] --base=URL [--strip-leading=N]
        [--output=FILE] &lt;csv&gt;
    sms2jwplayer fetch [--verbose] [--base-name=NAME]
    sms2jwplayer genupdatejob [--verbose] [--strip-leading=N]
        [--output=FILE] &lt;csv&gt; &lt;metadata&gt;...
    sms2jwplayer applyupdatejob [--verbose] [&lt;update&gt;]
    sms2jwplayer analytics [--output=FILE] [--verbose] &lt;date&gt;

Options:
    -h, --help          Show a brief usage summary.
    -v, --verbose       Increase verbosity.

    &lt;csv&gt;               CSV export from SMS.
    &lt;metadata&gt;          JSON file containing video list result as returned by jwplayer /videos/list
                        endpoint.
    &lt;update&gt;            JSON file specifying update jobs as returned from genupdatejob. If omitted,
                        use stdin.

    &lt;date&gt;              Date in YYYY-MM-DD format.

    --output=FILE       Output file. If omitted, use stdout.

    --base=URL          Base URL to use for links in MRSS feed.
    --strip-leading=N   Number of leading components of filename path to strip
                        from filenames in the CSV. [default: 1]

    --base-name=NAME    Base of filename used to save results to.
                        [default: videos_]

Sub commands:

    genmrss             Generate an MRSS feed for the export.
    fetch               Fetch details on all videos in jwplayer.
    genupdatejob        Generate list of missing metadata for each video key.
    analytics           Generate SMS analytics for a given day.

</pre></div>
</div>
</div>
<div class="section" id="generating-an-mrss-feed">
<h2>Generating an MRSS Feed<a class="headerlink" href="#generating-an-mrss-feed" title="Permalink to this headline">¶</a></h2>
<p>This tool ships with a script which can be used to automatically export the
current state of the SMS archive into a MRSS feed suitable for passing to
jwplayer. The script can be found at <code class="docutils literal"><span class="pre">scripts/export_sms_feed.sh</span></code>.</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span><span class="c1"># Output SMS feed URL directly from SMS database.</span>
<span class="c1">#</span>
<span class="c1"># Usage:</span>
<span class="c1">#	export_sms_feed.sh &lt;sms-host&gt; &lt;base-url&gt; &lt;feed&gt; [&lt;csv&gt;]</span>
<span class="c1">#</span>
<span class="c1"># Options:</span>
<span class="c1">#</span>
<span class="c1">#	&lt;sms-host&gt;    Hostname of SMS box to log into. (E.g. root@example.com)</span>
<span class="c1">#	&lt;base-url&gt;    Base URL of SMS archive endpoint.</span>
<span class="c1">#	              (E.g. http://user:pass@download.example.com:1234/archive)</span>
<span class="c1">#	&lt;file&gt;        File to write feed to or &quot;-&quot; for stdout</span>
<span class="c1">#	&lt;csv&gt;         If specified, write CSV to this file.</span>
<span class="c1">#</span>
<span class="c1"># Environment variables:</span>
<span class="c1">#</span>
<span class="c1">#	SMS_SSH       SSH client to use instead of &quot;ssh&quot;.</span>
</pre></div>
</div>
<p>You’ll need access to an SMS hosting box in order to run the script. You’ll also
need to know where the SMS download archive is hosted. For example, if the
archive is hosted at <a class="reference external" href="http://user:pass&#64;example.com/archive">http://user:pass&#64;example.com/archive</a> and you have have
access to the SMS hosting box as <code class="docutils literal"><span class="pre">user&#64;sms-host-1</span></code>, you can generate a
suitable MRSS feed via:</p>
<div class="code console highlight-default"><div class="highlight"><pre><span></span>$ export_sms_feed.sh user@sms-host-1 http://user:pass@example.com/archive feed.rss
</pre></div>
</div>
<p>The script will log into the SMS hosting box and extract information for the
feed straight from the Postgres database.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">psql</span></code> command-line client must be installed on the SMS hosting box.</p>
</div>
<p>After the command completes, a MRSS feed will be present in the <code class="docutils literal"><span class="pre">feed.rss</span></code>.
This RSS feed file may then be copied to a web-host so that jwplayer may be
direct at it.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="https://support.jwplayer.com/customer/portal/articles/2798456">Importing Content in Bulk Using MRSS Feeds</a> on the
jwplayer support pages.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="csvexport.html" class="btn btn-neutral float-right" title="CSV Export" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="sms2jwplayer: export SMS content to jwplayer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, University of Cambridge Information Services.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>